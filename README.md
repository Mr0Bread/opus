# 🪶 Spalva

## Why

#### 🥷🏼 Make your requests extensible

The GraphQL requests generated by this library are easily extensible by [the plugin system](https://github.com/plugjs/plugjs).

#### 🪶 Stay lightweight

This library is TINY and still provides all of the main functionality for GraphQL interactions.

#### 👩‍⚖️ Definitely typed

Generate GraphQL requests with Builder pattern and receive properly structurally typed responses upon fetching!
![Hnet com-image](https://user-images.githubusercontent.com/46347627/113285078-304d1b80-92f3-11eb-91f4-c7a491a39996.gif)

## What

#### 👷‍♂️ Building fields

Full GraphQL functionality is supported: fields, nested fields, inline fragments, arguments.

```js
const dragonFields = ['name', 'neck_length', 'age'] as const;

const dragonsQuery = new Field('dragons')
    .addArgument('limit', 'Int', 5)
    .addFieldList(dragonFields)
    .addField(new Field('children')
        .addFieldList(dragonFields)
    )
    .addField(new InlineFragment('Fire')
        .addField('fire_temperature')
    )
    .addField(new InlineFragment('Ice')
        .addField('ice_density')
    )
```

#### ⚙️ Configuring the client

It is necessary to set up the client before fetching any data. See the required configuration steps below.

-  Endpoint


   -  `client.setEndpoint(endpoint: string)` allows to configure this in runtime 


   -  Setting `GRAPHQL_ENDPOINT` in `process.env` will also set the endpoint


   -  It defaults to `/graphql`

-  Headers

   -  `client.setHeaders(headers: any)` will set the headers to use when fetching requests

#### 🪢 Using a middleware

It is possible to set a middleware, in order to support custom data structures coming from backend. A target of using a middleware is to make the response correlate with the type generated by the `Field` class.

```js
// By default, this middleware is used
client.setMiddleware(async (response: any): unknown => {
    const { data, errors } = response;
    if (errors) {
        throw new Error('...');
    }

    return data;
})
```

#### 🐕 Fetching some requests!

The `client` provides an opportunity to fetch queries and mutations, as well as fetch combined queries and combined mutations.

```js
// Single requests
const queryResult = await client.postQuery(someQuery);
const mutationResult = await client.postMutation(someMutation);

// Combined queries and mutations work the same
const combinedQueryResult = await client.postQuery(new CombinedField
    .addField(firstQuery)
    .addField(secondQuery)
);
```
